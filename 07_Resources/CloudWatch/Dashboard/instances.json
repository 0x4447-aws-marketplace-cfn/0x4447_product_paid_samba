{
	"CloudWatchDashboardInstances": {
		"Type": "AWS::CloudWatch::Dashboard",
		"Properties": {
			"DashboardName": { "Fn::Sub": "0x4447_samba_${UniqueIdentifierParam}_${AWS::Region}" },
			"DashboardBody": {
				"Fn::Sub": [
					"{\n    \"widgets\": [\n        {\n            \"height\": 3,\n            \"width\": 20,\n            \"y\": 0,\n            \"x\": 4,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"metrics\": [\n                    [ \"AWS/EC2\", \"CPUUtilization\", \"InstanceId\", \"${InstanceId}\" ]\n                ],\n                \"view\": \"timeSeries\",\n                \"stacked\": false,\n                \"region\": \"${Region}\",\n                \"title\": \"CPU\",\n                \"period\": 300,\n                \"stat\": \"Average\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 17,\n            \"y\": 3,\n            \"x\": 7,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"view\": \"timeSeries\",\n                \"stacked\": false,\n                \"metrics\": [\n                    [ \"AWS/EC2\", \"NetworkIn\", \"InstanceId\", \"${InstanceId}\" ],\n                    [ \".\", \"NetworkOut\", \".\", \".\" ]\n                ],\n                \"region\": \"${Region}\",\n                \"title\": \"Network\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 14,\n            \"y\": 6,\n            \"x\": 10,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"metrics\": [\n                    [ \"AWS/EC2\", \"CPUCreditBalance\", \"InstanceId\", \"${InstanceId}\", { \"yAxis\": \"right\" } ],\n                    [ \".\", \"CPUSurplusCreditsCharged\", \".\", \".\" ],\n                    [ \".\", \"CPUCreditUsage\", \".\", \".\" ]\n                ],\n                \"view\": \"timeSeries\",\n                \"stacked\": false,\n                \"region\": \"${Region}\",\n                \"stat\": \"Average\",\n                \"period\": 300,\n                \"title\": \"CPU Credit\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 14,\n            \"y\": 9,\n            \"x\": 10,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"metrics\": [\n                    [ \"${NameSpace}\", \"mem_used\", \"host\", \"${PrivateDnsName}\" ],\n                    [ \".\", \"mem_available\", \".\", \".\" ]\n                ],\n                \"view\": \"timeSeries\",\n                \"stacked\": false,\n                \"region\": \"${Region}\",\n                \"period\": 300,\n                \"stat\": \"Average\",\n                \"title\": \"RAM\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 10,\n            \"y\": 9,\n            \"x\": 0,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"metrics\": [\n                    [ \"${NameSpace}\", \"mem_total\", \"host\", \"${PrivateDnsName}\" ],\n                    [ \".\", \"mem_used\", \".\", \".\" ],\n                    [ \".\", \"mem_available\", \".\", \".\" ]\n                ],\n                \"view\": \"singleValue\",\n                \"stacked\": false,\n                \"region\": \"${Region}\",\n                \"period\": 300,\n                \"stat\": \"Average\",\n                \"singleValueFullPrecision\": false,\n                \"title\": \"RAM\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 7,\n            \"y\": 15,\n            \"x\": 17,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"view\": \"timeSeries\",\n                \"stacked\": false,\n                \"metrics\": [\n                    [ \"${NameSpace}\", \"processes_running\", \"host\", \"${PrivateDnsName}\" ],\n                    [ \".\", \"processes_sleeping\", \".\", \".\" ],\n                    [ \".\", \"processes_stopped\", \".\", \".\" ],\n                    [ \".\", \"processes_total\", \".\", \".\" ],\n                    [ \".\", \"processes_zombies\", \".\", \".\" ]\n                ],\n                \"region\": \"${Region}\",\n                \"title\": \"Processes\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 14,\n            \"y\": 12,\n            \"x\": 10,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"view\": \"timeSeries\",\n                \"stacked\": false,\n                \"metrics\": [\n                    [ \"${NameSpace}\", \"disk_free\", \"path\", \"/\", \"host\", \"${PrivateDnsName}\", \"device\", \"nvme0n1p1\", \"fstype\", \"xfs\" ],\n                    [ \".\", \"disk_used\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\" ]\n                ],\n                \"region\": \"${Region}\",\n                \"title\": \"HDD\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 10,\n            \"y\": 12,\n            \"x\": 0,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"metrics\": [\n                    [ \"${NameSpace}\", \"disk_total\", \"path\", \"/\", \"host\", \"${PrivateDnsName}\", \"device\", \"nvme0n1p1\", \"fstype\", \"xfs\" ],\n                    [ \".\", \"disk_free\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\" ],\n                    [ \".\", \"disk_used\", \".\", \".\", \".\", \".\", \".\", \".\", \".\", \".\" ]\n                ],\n                \"view\": \"singleValue\",\n                \"stacked\": false,\n                \"region\": \"${Region}\",\n                \"period\": 300,\n                \"stat\": \"Average\",\n                \"title\": \"HDD\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 17,\n            \"y\": 15,\n            \"x\": 0,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"metrics\": [\n                    [ \"${NameSpace}\", \"processes_total\", \"host\", \"${PrivateDnsName}\" ],\n                    [ \".\", \"processes_sleeping\", \".\", \".\" ],\n                    [ \".\", \"processes_running\", \".\", \".\" ],\n                    [ \".\", \"processes_stopped\", \".\", \".\" ],\n                    [ \".\", \"processes_zombies\", \".\", \".\" ]\n                ],\n                \"view\": \"singleValue\",\n                \"stacked\": false,\n                \"region\": \"${Region}\",\n                \"period\": 300,\n                \"stat\": \"Average\",\n                \"title\": \"Processes\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 7,\n            \"y\": 3,\n            \"x\": 0,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"view\": \"singleValue\",\n                \"stacked\": false,\n                \"metrics\": [\n                    [ \"AWS/EC2\", \"NetworkIn\", \"InstanceId\", \"${InstanceId}\" ],\n                    [ \".\", \"NetworkOut\", \".\", \".\" ]\n                ],\n                \"region\": \"${Region}\",\n                \"title\": \"Network\",\n                \"period\": 300\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 4,\n            \"y\": 0,\n            \"x\": 0,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"metrics\": [\n                    [ \"AWS/EC2\", \"CPUUtilization\", \"InstanceId\", \"${InstanceId}\" ]\n                ],\n                \"view\": \"singleValue\",\n                \"stacked\": false,\n                \"region\": \"${Region}\",\n                \"title\": \"CPU\",\n                \"period\": 300,\n                \"stat\": \"Average\"\n            }\n        },\n        {\n            \"height\": 3,\n            \"width\": 10,\n            \"y\": 6,\n            \"x\": 0,\n            \"type\": \"metric\",\n            \"properties\": {\n                \"metrics\": [\n                    [ \"AWS/EC2\", \"CPUCreditBalance\", \"InstanceId\", \"${InstanceId}\", { \"yAxis\": \"right\" } ],\n                    [ \".\", \"CPUCreditUsage\", \".\", \".\" ],\n                    [ \".\", \"CPUSurplusCreditsCharged\", \".\", \".\" ]\n                ],\n                \"view\": \"singleValue\",\n                \"stacked\": false,\n                \"region\": \"${Region}\",\n                \"stat\": \"Average\",\n                \"period\": 300,\n                \"title\": \"CPU Credit\"\n            }\n        }\n    ]\n}",
					{
						"InstanceId": { "Ref": "EC2Instance" },
						"InstanceType": { "Ref": "InstanceTypeParam" },
						"Region": { "Ref": "AWS::Region" },
                        "NameSpace": { "Fn::Sub": "0x4447_samba_${UniqueIdentifierParam}" },
                        "PrivateDnsName": { "Fn::GetAtt": ["EC2Instance", "PrivateDnsName"] }
					}
				]
			}
		}
	}
}